<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MXene Phonon Database</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 1rem; }
    .search-bar { margin-bottom: 1rem; padding: 0.5rem; width: 100%; max-width: 400px; }
    .periodic-table { display: grid; grid-template-columns: repeat(18, 2.5rem); gap: 0.3rem; }
    .element { border: 1px solid #ccc; padding: 0.3rem; text-align: center; cursor: pointer; border-radius: 6px; background: #f8f8f8; }
    .element:hover { background: #e0f0ff; }
    /* Modal */
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; }
    .modal-content { background: #fff; padding: 1rem; border-radius: 8px; max-width: 500px; width: 100%; }
    .modal-header { font-size: 1.2rem; font-weight: bold; margin-bottom: 0.5rem; }
    .close-btn { float: right; cursor: pointer; color: #888; font-size: 1.2rem; }
  </style>
</head>
<body>
  <h1>MXene Phonon Database</h1>

  <input id="searchInput" class="search-bar" type="text" placeholder="Search element by name, symbol, or number" />

  <div id="periodicTable" class="periodic-table"></div>

  <!-- Modal -->
  <div id="elementModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close-btn">&times;</span>
      <div class="modal-header" id="modalTitle"></div>
      <div id="elementDetails"></div>
      <hr />
      <div id="compoundProperties"></div>
    </div>
  </div>

  <script>
    let elements = [];
    let compoundsDB = {};

    // Load periodic table data (full 118 elements)
    fetch("https://raw.githubusercontent.com/Bowserinator/Periodic-Table-JSON/master/PeriodicTableJSON.json")
      .then(res => res.json())
      .then(data => {
        elements = data.elements.map(el => ({
          number: el.number,
          symbol: el.symbol,
          name: el.name,
          group: el.category
        }));
        renderTable();
      });

    // Load compounds manifest generated by build_manifest.py
    fetch("compounds.json")
      .then(res => res.json())
      .then(data => {
        compoundsDB = data;
      });

    const table = document.getElementById("periodicTable");
    const modal = document.getElementById("elementModal");
    const closeModal = document.getElementById("closeModal");
    const modalTitle = document.getElementById("modalTitle");
    const elementDetails = document.getElementById("elementDetails");
    const compoundProperties = document.getElementById("compoundProperties");

    // Render periodic table
    function renderTable(filter = "") {
      table.innerHTML = "";
      elements.forEach(el => {
        if (
          el.symbol.toLowerCase().includes(filter) ||
          el.name.toLowerCase().includes(filter) ||
          String(el.number) === filter ||
          filter === ""
        ) {
          const cell = document.createElement("div");
          cell.className = "element";
          cell.innerHTML = `<strong>${el.symbol}</strong><br/><small>${el.number}</small>`;
          cell.onclick = () => showModal(el);
          table.appendChild(cell);
        }
      });
    }

    function showModal(el) {
      modal.style.display = "flex";
      modalTitle.innerText = `${el.name} (${el.symbol})`;
      elementDetails.innerHTML = `
        <p><b>Atomic Number:</b> ${el.number}</p>
        <p><b>Group:</b> ${el.group}</p>
      `;

      // Match compounds containing this element
      const results = Object.entries(compoundsDB).filter(([compound, props]) =>
        props.elements.includes(el.symbol)
      );

      if (results.length > 0) {
        compoundProperties.innerHTML = "<h3>MXene Compounds</h3>";
        results.forEach(([compound, props]) => {
          compoundProperties.innerHTML += `
            <div style="margin-bottom:0.8rem">
              <b>${compound}</b><br/>
              <a href="${props.path}index.html" target="_blank">View details</a>
            </div>
          `;
        });
      } else {
        compoundProperties.innerHTML = "<p>No MXene data available for this element.</p>";
      }
    }

    closeModal.onclick = () => (modal.style.display = "none");
    window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };

    // Search functionality
    document.getElementById("searchInput").addEventListener("input", e => {
      renderTable(e.target.value.toLowerCase());
    });
  </script>
</body>
</html>

